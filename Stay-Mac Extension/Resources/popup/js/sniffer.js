(()=>{var e={7022:(e,t,o)=>{let r;o(7658),"undefined"!==typeof window.browser&&(r=window.browser),"undefined"!==typeof window.chrome&&(r=window.chrome);const n=r;(function(){let e=!1;try{t(),document.addEventListener("securitypolicyviolation",(t=>{e=!0,o(e)}))}catch(l){}function t(){const e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let t=window.location.host,r=document.createElement("script");r.type="text/javascript",r.id="stay_inject_parse_video_js_"+t;let n=`\n\nlet handleVideoInfo = ${o}\n\nhandleVideoInfo(false);`;if(r.appendChild(document.createTextNode(n)),document.body)document.body.appendChild(r);else{let t=new e(((e,o)=>{document.body&&(document.body.appendChild(r),t.disconnect())}));t.observe(document.documentElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}}function o(e){let t=window.location.href,o=window.location.host,r=[],i=new Set,l=new Set;const a=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let d,c=[];const s={isMobile:function(){const e=navigator.userAgent;let t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=t.filter((t=>e.includes(t)));return!!o.length},queryURLParams:function(e,t){const o=new RegExp("[?&#]+"+t+"=([^?&#]+)"),r=o.exec(e);return r&&r[1]?r[1]:""},matchUrlInString:function(e){const t=new RegExp("(https?|http)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g"),o=e.match(t);return o&&o.length?o[0]:""},isURL:function(e){return!!e&&/^http[s]?:\/\/.*/.test(e)},completionSourceUrl:function(e){return e?(/^(f|ht)tps?:\/\//i.test(e)||(e=/^\/\//i.test(e)?window.location.protocol+e:window.location.origin+e),e):""},checkCharLengthAndSubStr:function(e,t=80){if(!e)return"";let o=e.replace(/[^x00-xff]/g,"01");return o.length<=t?e:e.substr(0,t)},getUrlPathName:function(e){let o="";o=this.isURL(e)?new URL(e).pathname:new URL(t).pathname;let r=o.split("/");return r=r.filter((e=>{if(e&&""!=e)return e})),r.pop()}};function u(e){d=document.querySelectorAll("video");let t=d&&d.length;t||(d=document.querySelectorAll(".post-content shreddit-player"),t=d&&d.length),t?m(d):(f(),e&&p())}function p(){for(let e=1;e<10;e++){let t;(function(e){t=setTimeout((()=>{d=document.querySelectorAll("video");let e=d&&d.length;e&&(m(d),c.forEach((e=>{clearTimeout(e)})))}),200*e)})(e),c.push(t)}}function f(){const e=new a((function(e){try{e.forEach((function(e){if(d=document.querySelectorAll("video"),"VIDEO"===e.target.nodeName&&d&&d.length)throw o=window.location.host,m(d),new Error("endloop")}))}catch(t){if("endloop"!==t.message)throw t}})),t={attributes:!0,childList:!0,characterData:!0,subtree:!0};e.observe(document,t)}function m(t){if(t&&t.length){let o=Array.from(t);if(o.forEach((e=>{if(!e||!(e instanceof HTMLElement))return;let t=e.getAttribute("src");if(!t){let o=e.querySelector("source");o&&(e=o,t=o.getAttribute("src"))}if(t=s.completionSourceUrl(t),t&&i.size&&i.has(t))return;let o=g(e);o.downloadUrl&&(i.add(t),r.push(o))})),window.postMessage({name:"VIDEO_INFO_CAPTURE",videoList:r}),console.log("parseVideoNodeList-----------result---------",r),e){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:r};n.runtime.sendMessage(e,(e=>{}))}}}function g(e){let r={},n=e.getAttribute("poster"),i=e.getAttribute("title"),a=e.getAttribute("src"),d=[];if(t=window.location.href,a=s.completionSourceUrl(a),!n){let e=document.querySelector("source[type='image/webp'] img");n=e?e.getAttribute("src"):"",i||(i=e?e.getAttribute("alt"):"")}if(o.indexOf("youtube.com")>-1){const e=s.queryURLParams(t,"v");if(l.size&&l.has(e))return console.log("videoId------isAlready",e),{};r=L(i,e),r&&Object.keys(r).length&&r.downloadUrl&&l.add(e)}else if(o.indexOf("baidu.com")>-1)r=O(e);else if(o.indexOf("bilibili.com")>-1)r=h(e);else if(o.indexOf("mobile.twitter.com")>-1)r=y(e);else if(o.indexOf("m.weibo.cn")>-1){let t=s.getUrlPathName(a);if(t&&l.size&&l.has(t))return{};r=w(e),r&&Object.keys(r).length&&r.downloadUrl&&l.add(t)}else if(o.indexOf("iesdouyin.com")>-1)r=b(e);else if(o.indexOf("douyin.com")>-1){const t=window.location.pathname;r=t.indexOf("/video")>-1?v(e):S(e)}else o.indexOf("m.toutiao.com")>-1?r=U(e):o.indexOf("m.v.qq.com")>-1?r=A(e):o.indexOf("www.reddit.com")>-1&&(r=_(e));return a||(a=r.downloadUrl),a=s.completionSourceUrl(a),n||(n=r.poster),i||(i=r.title),r.qualityList&&r.qualityList.length&&(d=r.qualityList),i||(i=s.getUrlPathName(a)),n=s.completionSourceUrl(n),r["title"]=i,r["poster"]=n,r["downloadUrl"]=a,r["hostUrl"]=t,r["qualityList"]=d,r}function h(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");let o=document.querySelector(".main-container .ep-info-pre .ep-info-title");return o&&(t.title=o.textContent),t}function y(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");let o=e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.nextElementSibling.childNodes[1];return o&&(o=o.querySelector(".css-1dbjc4n .r-92ivih.r-1t01tom .r-1t982j2.r-1j3t67a .css-1dbjc4n.r-1kw4oii a[data-testid='tweetText'] span"),o&&(t.title=s.checkCharLengthAndSubStr(o.textContent))),t}function w(e){let o={};return o.poster=e.getAttribute("poster"),o.downloadUrl=e.getAttribute("src"),t.match(/^.*\/detail\/.*/g)&&(o.title=s.checkCharLengthAndSubStr(document.querySelector(".weibo-main .weibo-text").textContent)),o}function b(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");let o=document.querySelector(".video-container img.poster");o&&(t.poster=o.getAttribute("src"));let r=document.querySelector(".desc .multi-line .multi-line_text");return r&&(t.title=r.textContent),t}function v(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");const o=document.querySelector("div[data-e2e=video-detail] div[data-e2e=detail-video-info] div h2");return o&&(t.title=o.textContent),t}function S(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");let o=e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(o){let e=o.querySelector(".imgBackground img");e&&(t.poster=e.getAttribute("src"));let r=o.querySelector(".video-info-detail .title span.e_h_fqNj");r&&(t.title=r.textContent)}return t}function U(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");const o=document.querySelector(".video .xgplayer-placeholder .xgplayer-poster");if(o){let e=o.getAttribute("style");if(e){let o=s.matchUrlInString(e);console.log("poster-----",o),t.poster=o}}const r=document.querySelector(".video .video-header .video-title-wrapper .video-title");return r&&(t.title=r.textContent),t}function A(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");const o=document.querySelector(".mod_play .player_container .txp_poster_img");if(o){let e=o.getAttribute("src");e=s.completionSourceUrl(e),t.poster=e}const r=document.querySelector(".mod_box .mod_bd .mod_video_info .video_title");if(r){let e=r.textContent;e=e?e.trim():"";const o=document.querySelector(".mod_box .mod_bd .mod_list_slider .slider_box .item.current span");o&&(e+=o.textContent,e=e?e.trim():""),t.title=e}return t}function _(e){let t={};t.poster=e.getAttribute("poster"),t.downloadUrl=e.getAttribute("src");const o=document.querySelector("shreddit-app shreddit-title");return o&&(t.title=o.getAttribute("title")),t}function O(e){let n={};if("activity.baidu.com"===o){const e=window.PAGE_DATA;if(e&&e.pageData&&e.pageData.remote&&e.pageData.remote.mainVideoList&&e.pageData.remote.mainVideoList.length){const o=e.pageData.remote.mainVideoList[0],l=e.pageData.remote.moreVideoList;return n["title"]=o.title,n["poster"]=o.poster,n["downloadUrl"]=o.videoUrl,l&&l.length&&l.forEach((e=>{i.size&&i.has(e.videoUrl)||r.push({title:e.title,poster:e.poster,downloadUrl:e.videoUrl,hostUrl:t})})),n}n["title"]=E();const o=document.querySelector(".stickyBlock .curVideoPlay video");return o&&(n["poster"]=o.getAttribute("poster"),n["downloadUrl"]=o.getAttribute("src")),n}if("mbd.baidu.com"===o){const e=window.jsonData;if(e&&e.curVideoMeta){const t=e.curVideoMeta;if(n=q(t),n&&Object.keys(n).length)return n}return n["title"]=E(),n["poster"]=x(),n}if("haokan.baidu.com"===o){const o=window.__PRELOADED_STATE__,r=s.queryURLParams(t,"vid"),i=e.getAttribute("src");if(i&&r&&i.indexOf(r)>-1){if(o&&o.curVideoMeta){const e=o.curVideoMeta;if(n=q(e),n&&Object.keys(n).length)return n}n["title"]=E(),n["poster"]=x()}else n["title"]=e.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title")?e.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title").textContent:"",n["poster"]=e.parentElement&&e.parentElement.querySelector("img.video-img")?e.parentElement.querySelector("img.video-img").getAttribute("src"):"";return n}return"pan.baidu.com"===o&&(n["title"]=E()),n}function q(e){if(!e)return{};let t={};if(t["title"]=e.title,t["poster"]=e.poster,t["downloadUrl"]=e.playurl,e.clarityUrl&&e.clarityUrl.length){let o=[];const r=e.clarityUrl;r.forEach((e=>{e.vodVideoHW;o.push({downloadUrl:e.url,qualityLabel:e.title,quality:e.key})})),t["qualityList"]=o}return t}function x(){const e=document.querySelector(".art-player-wrapper .art-video-player .art-poster");if(e){let t=e.getAttribute("style");if(t)return s.matchUrlInString(t)}const t=document.querySelector("#bdMainPlayer .art-video-player .art-poster");if(t){let e=t.getAttribute("style");if(e)return s.matchUrlInString(e)}return""}function E(){const e=document.querySelector(".adVideoPageV3 .curVideoInfo h3.videoTitle");if(e)return e.textContent;const t=document.querySelector(".video-info .video-info-title");if(t)return t.textContent;const o=document.querySelector(".video-main .video-content .video-title .video-title-left");return o?o.textContent:""}function L(e,t){let o={};const r=window.ytInitialPlayerResponse;if(r&&r.videoDetails&&r.streamingData&&t===r.videoDetails.videoId){const t=r.videoDetails;let n=t.title?t.title:"";o["title"]=n;let i=t.thumbnail;if(i){let e=i.thumbnails;e&&e.length&&(o["poster"]=e.pop().url)}const l=r.streamingData,a=l.formats;if(e=e||"",a&&a.length&&e.replace(/\s+/g,"")===n.replace(/\s+/g,"")){let e=[],t=new Set;a.forEach((o=>{let r=o.mimeType;r.indexOf("video/mp4")>-1&&o.url&&!t.has(o.quality)&&(t.add(o.quality),e.push({downloadUrl:o.url,qualityLabel:o.qualityLabel,quality:o.quality}))})),e&&e.length&&(o["qualityList"]=e),o["downloadUrl"]=I()}else o["title"]=N(),o["downloadUrl"]=I(),o["poster"]=C()}else o={},o["title"]=N(),o["poster"]=C(),o["downloadUrl"]=I();return o}function I(){let e=document.querySelector(".html5-video-player .html5-video-container video");return e?e.getAttribute("src"):""}function N(){const e=document.querySelector(".slim-video-metadata-header .slim-video-information-content .slim-video-information-title");if(e)return e.textContent;const t=document.querySelector("#title h1.style-scope");return t?t.textContent:""}function C(){const e=document.querySelector(".ytp-cued-thumbnail-overlay-image");if(console.log(e),e){console.log("overlayImg-------",e);let t=e.getAttribute("style");if(t)return s.matchUrlInString(t)}const t=document.querySelector(".html5-video-player .ytp-cued-thumbnail-overlay .ytp-cued-thumbnail-overlay-image");if(t){let e=t.getAttribute("style");if(e)return s.matchUrlInString(e)}return""}function D(){function t(e){let t=/^(https?:\/\/|\/).*\.(mp4|m3u8)$/;return null!=e.match(t)}let o=new Set;XMLHttpRequest.prototype.reallyOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(r,i,l,a,d){if(this.reallyOpen(r,i,l,a,d),t(i)&&!o.has(i)&&(o.add(i),console.log("VIDEO_LINK_CAPTURE: "+i),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:o}),e)){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:o};n.runtime.sendMessage(e,(e=>{}))}};let r=window.fetch;window.fetch=function(i,l){let a="object"==typeof i?i.url:i;if(t(a)&&!o.has(a)&&(o.add(a),console.log("VIDEO_LINK_CAPTURE: "+a),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:o}),e)){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:o};n.runtime.sendMessage(e,(e=>{}))}return r(i,l)}}u(!1),document.onreadystatechange=()=>{console.log("document.readyState==",document.readyState),"complete"===document.readyState&&(console.log("readyState-------------------",document.readyState),u(!0))},D()}let r=[],i=new Set;window.addEventListener("message",(e=>{if(!e||!e.data||!e.data.name)return;const t=e.data.name;if("VIDEO_LINK_CAPTURE"===t){let t=e.data.urls?e.data.urls:new Set;console.log("snifffer.VIDEO_LINK_CAPTURE-----\x3etempSet=",t),i=t;let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:i};n.runtime.sendMessage(o,(e=>{}))}else if("VIDEO_INFO_CAPTURE"===t){let t=e.data.videoList?e.data.videoList:[];r=t,console.log("snifffer.VIDEO_INFO_CAPTURE-----\x3evideoInfoList=",r);let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:r};n.runtime.sendMessage(o,(e=>{}))}}))})()}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.m=e,(()=>{var e=[];o.O=(t,r,n,i)=>{if(!r){var l=1/0;for(s=0;s<e.length;s++){r=e[s][0],n=e[s][1],i=e[s][2];for(var a=!0,d=0;d<r.length;d++)(!1&i||l>=i)&&Object.keys(o.O).every((e=>o.O[e](r[d])))?r.splice(d--,1):(a=!1,i<l&&(l=i));if(a){e.splice(s--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var s=e.length;s>0&&e[s-1][2]>i;s--)e[s]=e[s-1];e[s]=[r,n,i]}})(),(()=>{o.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return o.d(t,{a:t}),t}})(),(()=>{o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.j=875})(),(()=>{var e={875:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,i,l=r[0],a=r[1],d=r[2],c=0;if(l.some((t=>0!==e[t]))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(d)var s=d(o)}for(t&&t(r);c<l.length;c++)i=l[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(s)},r=self["webpackChunkstay_popup"]=self["webpackChunkstay_popup"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=o.O(void 0,[998],(()=>o(7022)));r=o.O(r)})();