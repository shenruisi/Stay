(()=>{var t={7022:(t,e,n)=>{let o;n(2801),n(7658),"undefined"!==typeof window.browser&&(o=window.browser),"undefined"!==typeof window.chrome&&(o=window.chrome);const i=o;(function(){try{t(),document.addEventListener("securitypolicyviolation",(t=>{e(!0)}))}catch(a){}function t(){const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let n=window.location.host,o=document.createElement("script");o.type="text/javascript",o.id="stay_inject_parse_video_js_"+n;let i=`\n\nlet handleVideoInfo = ${e}\n\nhandleVideoInfo(false);`;if(o.appendChild(document.createTextNode(i)),document.body)document.body.appendChild(o);else{let e=new t(((t,n)=>{document.body&&(document.body.appendChild(o),e.disconnect())}));e.observe(document.documentElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}}function e(t){let e="",n=window.location.href,o=window.location.host,r=[],s=new Set;const l=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let d,c=[];const u={isMobile:function(){const t=navigator.userAgent;let e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=e.filter((e=>t.includes(e)));return!!n.length},queryURLParams:function(t,e){const n=new RegExp("[?&#]+"+e+"=([^?&#]+)"),o=n.exec(t);return o&&o[1]?o[1]:""},matchUrlInString:function(t){const e=new RegExp("(https?|http)?(:)?//[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g"),n=t.match(e);return n&&n.length?n[0]:""},isURL:function(t){return!!t&&/^http[s]?:\/\/.*/.test(t)},completionSourceUrl:function(t){return t?(/^(f|ht)tps?:\/\//i.test(t)||(t=/^\/\//i.test(t)?window.location.protocol+t:window.location.origin+t),t):""},checkCharLengthAndSubStr:function(t,e=80){if(!t)return"";let n=t.replace(/[^x00-xff]/g,"01");return n.length<=e?t:t.substr(0,e)},getUrlPathName:function(t){let e="";e=this.isURL(t)?new URL(t).pathname:new URL(n).pathname;let o=e.split("/");return o=o.filter((t=>{if(t&&""!=t)return t})),o.pop()},generateUuid:function(t,e){t=t||32;let n,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=[];if(e=e||o.length,t)for(n=0;n<t;n++)i[n]=o[0|Math.random()*e];else{let t;for(i[8]=i[13]=i[18]=i[23]="_",i[14]="4",n=0;n<36;n++)i[n]||(t=0|16*Math.random(),i[n]=o[19==n?3&t|8:t])}return i.join("")},isBase64(t){if(!t)return!1;if(/^data:.*\w+;base64,/.test(t))return!0;if(""===t||""===t.trim())return!1;try{return window.btoa(window.atob(t))==t}catch(e){return!1}},isDark(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches},parseToDOM(t){let e=document.createElement("template");return"string"==typeof t?(e.innerHTML=t,e.content):t},getHostname(t){if(!t)return"";try{return new URL(t).hostname.toLowerCase()}catch(a){return t.split("/")[0].toLowerCase()}},div(t,e){let n,o,i=0,r=0;try{i=t.toString().split(".")[1].length}catch(a){i=0}try{r=e.toString().split(".")[1].length}catch(a){r=0}return n=Number(t.toString().replace(".","")),o=Number(e.toString().replace(".","")),this.mul(n/o,Math.pow(10,r-i))},sub(t,e){let n,o,i;try{n=t.toString().split(".")[1].length}catch(r){n=0}try{o=e.toString().split(".")[1].length}catch(r){o=0}return i=Math.pow(10,Math.max(n,o)),(this.mul(t,i)-this.mul(e,i))/i},mul(t,e){let n=0,o=t.toString(),i=e.toString();try{n+=o.split(".")[1].length}catch(r){}try{n+=i.split(".")[1].length}catch(r){}return Number(o.replace(".",""))*Number(i.replace(".",""))/Math.pow(10,n)},add(t,e){let n,o,i;try{n=t.toString().split(".")[1].length}catch(r){n=0}try{o=e.toString().split(".")[1].length}catch(r){o=0}return i=Math.pow(10,Math.max(n,o)),(this.mul(t,i)+this.mul(e,i))/i}};class p{constructor(t,e){this.dom=t,this.timer=0,this.init(e)}init(t){this.touchstart(t),this.touchend(),this.touchmove(),this.bindLongPressEventFlag()}bindLongPressEventFlag(){this.dom.setAttribute("stay-long-press","yes")}touchstart(t){const e=this;e.dom.removeEventListener("touchstart",(function(n){e.handleLongPress(n,t)})),e.dom.addEventListener("touchstart",(function(n){return e.handleTargetTouchend(n.target),e.timer=setTimeout(((t,n)=>{e.handleLongPress(t,n)}),600,n,t),!1}),!1)}handleTargetTouchend(t){const e=this;t&&t.addEventListener("touchend",(n=>{e.handleTouchend(n,t)}))}handleLongPress(t,e){if(t.preventDefault(),t.stopPropagation(),m(this.dom))return;let n=t.changedTouches[0];try{n.target.addEventListener("contextmenu",(function(t){t.preventDefault()}))}catch(a){}"function"===typeof e?(e(),this.timer=0):console.error("callback is not a function!")}touchend(){const t=this;t.dom.removeEventListener("touchend",(function(e){t.handleTouchend(e,null)})),t.dom.addEventListener("touchend",(function(e){return t.handleTouchend(e,null),!1}))}handleTouchend(t,e){const n=this;if(!m(this.dom)&&(t.stopPropagation(),clearTimeout(this.timer),0!=this.timer))try{e&&e.removeEventListener("touchend",(t=>{clearTimeout(n.timer)}))}catch(a){}}touchmove(){const t=this;function e(e){m(t.dom)||(clearTimeout(t.timer),t.timer=0)}t.dom.removeEventListener("touchmove",(function(t){e(t)})),t.dom.addEventListener("touchmove",(function(t){return e(t),!1}))}}function m(t){if(!t)return!0;let e=window.getComputedStyle(t);return!!e&&("none"===e.display||"hidden"===e.visibility)}class f{constructor(t,e){this.dom=t,this.stayLongPressTimer=0,this.distance=10,this.init(e)}getDomPageStartX(){return this.dom.getBoundingClientRect().left}getDomPageStartY(){return(document.documentElement.scrollTop||window.pageYOffset)+this.dom.getBoundingClientRect().top}getDomPageEndX(){return this.getDomPageStartX()+this.dom.clientWidth}getDomPageEndY(){return this.getDomPageStartY()+this.dom.clientHeight}init(t){this.touchstart(t),this.touchend(),this.touchmove(),this.bindLongPressEventFlag()}bindLongPressEventFlag(){this.dom.setAttribute("stay-long-press","yes")}touchstart(t){const e=this;document.body.removeEventListener("touchstart",(function(n){return e.handleTargetEvent(n,t),!1})),document.body.addEventListener("touchstart",(function(n){return e.handleTargetTouchend(n.target),e.handleTargetEvent(n,t),!1}),!1)}handleTargetTouchend(t){const e=this;t&&t.addEventListener("touchend",(n=>{e.touchEndCallback(n,t)}))}handleTargetEvent(t,e){t.stopPropagation(),t.preventDefault();const n=this;let o=t.changedTouches[0];const i=o.pageX,r=o.pageY;!m(n.dom)&&Math.abs(o.pageX-i)<=n.distance&&i>=n.getDomPageStartX()&&i<=n.getDomPageEndX()&&r>=n.getDomPageStartY()&&r<=n.getDomPageEndY()&&(this.stayLongPressTimer=window.setTimeout(((t,e)=>{n.stayLongPressTimer=0;try{let n=t.target.classList;n.contains("__stay-unselect")||n.add("__stay-unselect"),n.contains("__stay-touch-action")||n.add("__stay-touch-action"),"function"===typeof e?e():console.error("callback is not a function!"),t.target.addEventListener("contextmenu",(function(t){t.preventDefault()}))}catch(a){}}),600,o,e))}touchend(){const t=this;document.body.removeEventListener("touchend",(function(e){t.touchEndCallback(e,null)})),document.body.addEventListener("touchend",(function(e){return t.touchEndCallback(e,null),!1}))}touchEndCallback(t,e){const n=this;if(t.stopPropagation(),!m(this.dom)&&(clearTimeout(this.stayLongPressTimer),0!=this.stayLongPressTimer))try{e&&e.removeEventListener("touchend",(t=>{n.touchEndCallback(t,null)}))}catch(a){}}touchmove(){const t=this;function e(){if(!m(t.dom))return window.clearTimeout(t.stayLongPressTimer),t.stayLongPressTimer=0,!1}document.body.removeEventListener("touchmove",(function(t){t.preventDefault(),t.stopPropagation(),e()})),document.body.addEventListener("touchmove",(function(t){return t.preventDefault(),t.stopPropagation(),e(),!1}))}}function h(t){y(),d=document.querySelectorAll("video");let e=d&&d.length;e||(d=document.querySelectorAll(".post-content shreddit-player"),e=d&&d.length),e?b(d):(b(),t&&g())}function g(){for(let t=1;t<10;t++){let e;(function(t){e=setTimeout((()=>{d=document.querySelectorAll("video");let t=d&&d.length;t&&(b(d),c.forEach((t=>{clearTimeout(t)})))}),200*t)})(t),c.push(e)}}function y(){const t=new l((function(t){try{t.forEach((function(t){o=window.location.host,d=document.querySelectorAll("video");const e=t.target.querySelectorAll("video");("VIDEO"===t.target.nodeName||e&&e.length)&&d&&d.length&&b(d)}))}catch(e){}})),e={attributes:!0,childList:!0,characterData:!0,subtree:!0};t.observe(document,e)}function b(e){if(e&&e.length){let t=e.length,n=0,o=Array.from(e);o.forEach((t=>{if(!t||!(t instanceof HTMLElement))return void n++;let e=t.getAttribute("stay-sniffing");e||(e=u.generateUuid(),t.setAttribute("stay-sniffing",e));const o=t;let i=t.getAttribute("src");if(!i){let e=t.querySelector("source");e&&(t=e,i=e.getAttribute("src"))}if(!i)return void n++;let r=U(t,o,e);r.downloadUrl||n++})),n==t&&L()}else L();if(window.postMessage({name:"VIDEO_INFO_CAPTURE",videoList:r}),t){let t={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:r};i.runtime.sendMessage(t,(t=>{}))}}function v(t,e,o){let i=o.downloadUrl;u.isURL(i)||(o.downloadUrl=n),o.downloadUrl=window.encodeURI(o.downloadUrl),w(t,e,o),s.size&&(s.has(o.videoUuid)||s.has(o.videoKey))?r.forEach((t=>(t.videoUuid!=o.videoUuid&&t.videoUuid!=o.videoKey||(t.downloadUrl=o.downloadUrl,t.poster=o.poster?o.poster:"",t.title=o.title,t.hostUrl=o.hostUrl,t.qualityList=o.qualityList?o.qualityList:[]),t))):(o.videoKey&&(s.add(o.videoKey),o.videoUuid||(o.videoUuid=o.videoKey)),o.videoUuid&&s.add(o.videoUuid),r.push(o))}async function w(t,n,o){if(!n)return;if(!e){const t=await _();e=t}if("a"!=e)return;if(!u.isMobile())return;let i=n.getAttribute("stay-long-press");if(i&&"yes"==i)return;const r=document.querySelector("#__style_sinffer_unselect");if(!r){let t='<style id="__style_sinffer_unselect">\n          .__stay-unselect, video{\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            -webkit-touch-callout: none;\n          }\n          .__stay-touch-action{\n            touch-action: none!important;\n          }\n        </style>';document.body.append(u.parseToDOM(t))}n.classList.add("__stay-unselect"),n.classList.add("__stay-touch-action");const a=o.hostUrl;if(a.indexOf("youtube.com")>-1){const e=document.querySelector("#player-control-overlay");e&&(e.classList.contains("__stay-touch-action")||e.classList.add("__stay-touch-action"),e.classList.contains("__stay-unselect")||e.classList.add("__stay-unselect"));const i=document.querySelector("#player-control-overlay .player-controls-background-container .player-controls-background");i&&(i.classList.contains("__stay-touch-action")||i.classList.add("__stay-touch-action"),i.classList.contains("__stay-unselect")||i.classList.add("__stay-unselect")),new p(n,(()=>{x(t,n,o)}))}else a.indexOf("mobile.twitter.com")>-1||a.indexOf("pornhub.com")>-1&&(n&&(n.classList.contains("__stay-touch-action")||n.classList.add("__stay-touch-action"),n.classList.contains("__stay-unselect")||n.classList.add("__stay-unselect")),new p(n,(()=>{x(t,n,o)})));new f(n,(()=>{x(t,n,o)}))}function _(){return new Promise(((e,n)=>{if(t)i.runtime.sendMessage({from:"sniffer",operate:"GET_STAY_AROUND"},(t=>{t.body&&"{}"!=JSON.stringify(t.body)&&e(t.body)}));else{const t=Math.random().toString(36).substring(2,9),n=o=>{if(o.data.pid!==t||"GET_STAY_AROUND_RESP"!==o.data.name)return;let i=o.data&&o.data.response?o.data.response.body:"b";e(i),window.removeEventListener("message",n)};window.postMessage({id:t,pid:t,name:"GET_STAY_AROUND"}),window.addEventListener("message",n)}}))}function x(e,n,o){let r=n.clientWidth,a=n.clientHeight,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,l=window.innerWidth||document.documentElement.innerWidth||document.body.innerWidth,d=n.getBoundingClientRect().top,c=n.getBoundingClientRect().left;"VIDEO"==n.tagName&&(d=n.parentNode.getBoundingClientRect().top,c=n.parentNode.getBoundingClientRect().left),c=10;let p=l,m=u.div(u.mul(p,9),16);a<u.div(s,2)&&(m=a),console.log("vWidth:",r,",vHeight:",a,",posterHeight:",m,",top:",d);let f=document.querySelector("#__stay_sinffer_modal");f||(f=y()),f.style.visibility="visible";const h=document.querySelector("#__stay_sinffer_modal ._stay-sinffer-popup"),g=document.querySelector("#__stay_sinffer_modal .__stay-sinffer-content");function y(){let n=[{title:o.title,downloadUrl:o.downloadUrl,poster:o.poster,hostUrl:u.getHostname(o.hostUrl),uuid:""}],r="stay://x-callback-url/snifferVideo?list="+encodeURIComponent(JSON.stringify(n)),l="background-color: rgb(247,247,247);",f="rgb(54, 54, 57)",h="#E0E0E0",g="background-color: rgba(0, 0, 0, 0.4);",y="background-color: rgba(255, 255, 255, 1);",b="color:#000000;",v=t?i.runtime.getURL("img/popup-download-light.png"):"https://res.stayfork.app/scripts/8DF5C8391ED58046174D714911AD015E/icon.png";u.isDark()&&(y="background-color: rgba(0, 0, 0, 1);",b="color:#DCDCDC;",l="background-color: rgb(54, 54, 57);",v=t?i.runtime.getURL("img/popup-download-dark.png"):"https://res.stayfork.app/scripts/CFFCD2186E164262E0E776A545327605/icon.png",f="rgb(247,247,247)",h="#37372F");let w=1,_=`<div stay-download="${r}" class="_stay-quality-item ">Download</div>`,x=o.qualityList;if(x&&x.length){let t="";w=0,x.forEach((e=>{n=[{title:o.title,downloadUrl:e.downloadUrl,poster:o.poster,hostUrl:u.getHostname(o.hostUrl),uuid:""}],r="stay://x-callback-url/snifferVideo?list="+encodeURIComponent(JSON.stringify(n)),t+=`<div stay-download="${r}" class="_stay-quality-item">${e.qualityLabel}</div>`,w+=1})),_=t}let U=d,L=d;if(d<0)L=0,s<=a&&(L=u.div(u.sub(s,m),2));else if(0==d)s<=a&&(L=u.div(u.sub(s,m),2));else{let t=u.add(10,36),e=u.add(u.add(m,t),u.add(u.mul(w,38),36));d>u.sub(s,e)&&(L=u.sub(s,e))}let E="",A=t?i.runtime.getURL("img/video-default.png"):"https://res.stayfork.app/scripts/BB8CD00276006365956C32A6556696AD/icon.png",q='<div class="__stay-poster-box" ><div class="__stay-default-poster"><img style="max-width:100%;max-height:100%;" src="'+A+'"/></div><span style="font-size:13px;padding-top: 20px; -webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;'+b+'">'+u.getHostname(o.hostUrl)+"</span></div>";o.poster&&(E="border-radius: 15px;",q=`<div class="__stay-video-poster" style="background:url('${o.poster}') 50% 50% no-repeat;background-size: cover;"></div>`);S(e,p,m);let O=`<style id="__style_sinffer_style">\n          .__stay-modal-box{\n            position: fixed; \n            z-index: 9999999; \n            width: 100%; \n            height: 100%; \n            text-align: center; \n            top: 0px;\n            -webkit-overflow-scrolling: touch;\n            margin: 0 auto;\n            transition: all 0.6s;\n            box-sizing: border-box;\n            visibility: hidden;\n          }\n          .__stay-show-modal{\n            ${g}\n            -webkit-backdrop-filter: blur(8px); \n          }\n          .__stay-sinffer-content{\n            width:100%;\n            position: absolute;\n            left: 0;\n            -webkit-transform: translate3d(0, ${U}px, 0);\n            transform: translate3d(0, ${U}px, 0);\n            will-change: transform;\n            -webkit-transition: -webkit-transform .4s cubic-bezier(0,0,.25,1) 80ms;\n            transition: transform .4s cubic-bezier(0,0,.25,1) 80ms;\n            box-sizing: border-box;\n          }\n          .__stay-trans{\n            -webkit-transform: translate3d(0,${L}px,0);\n            transform: translate3d(0,${L}px,0);\n          }\n          .__stay-content{\n            width:100%;\n            position: relative;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n          }\n          ._stay-sinffer-popup{\n            width:230px;padding-top: 10px;box-sizing: border-box;border-radius:15px;\n            ${l}\n            position: relative;\n            margin: 16px auto 0 auto;\n            z-index:999999;\n            visibility: hidden;\n            animation: fadein .5s;\n          }\n          .__stay-sinffer-poster{\n            width: 100%;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n            height: ${m}px;\n            padding: 0 ${c}px;\n            margin:0 auto;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n            box-sizing: border-box;\n            box-shadow: 0 0px 10px rgba(54,54,57,0.1);\n            transition: All 0.4s ease-in-out;\n            -webkit-transition: All 0.4s ease-in-out;\n            -moz-transition: All 0.4s ease-in-out;\n            -o-transition: All 0.4s ease-in-out;\n            animation-name: zoom;\n            animation-duration: 0.6s;\n          }\n          .__stay-video-poster{\n            // object-fit: contain;\n            // object-position: center;\n            width:100%;\n            height:100%;\n            background-position: center;\n            background-repeat: no-repeat;\n            border-radius: 15px;\n           \n          }\n          .__stay-poster-box{\n            width:100%;\n            height:100%;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            ${y}\n            border-radius: 10px;\n            box-shadow: 0 0px 10px rgba(54,54,57,0.1);\n          }\n          .__stay-default-poster{\n            width:80px;\n            height:60px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            justify-items: center;\n            align-items: center;\n            box-sizing: border-box;\n          }\n          ._stay-sinffer-title{\n            padding-left: 15px;\n            padding-right: 15px;\n            width: 100%;\n            height:36px;\n            line-height: 18px;\n            word-break:break-all;\n            word-wrap:break-word;\n            color: ${f};\n            -webkit-box-orient: vertical;\n            -webkit-user-select: none;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            display: -webkit-box;\n            -webkit-line-clamp: 2;\n            text-align: left;\n            margin-bottom: 10px;\n            box-sizing: border-box;\n            font-size: 16px;\n          }\n          ._stay-sinffer-title span{\n            font-weight: 600;\n            color: ${b}\n          }\n          ._stay-sinffer-download{\n            width:100%;\n            box-sizing: border-box;\n            display: flex;\n            justify-content: flex-start;\n            flex-direction: column;\n            align-items: center;\n          }\n          ._stay-quality-item{\n            height: 38px;\n            box-sizing: border-box;\n            width:100%;\n            padding-right: 20px;\n            position: relative;\n            color: ${f};\n            text-align:left;\n            font-size: 16px;\n            border-top: 0.5px solid ${h};\n            padding: 0 15px;\n            display: flex;\n            align-items: center;\n            -webkit-user-select: none;\n            -moz-user-select: none;\n            -ms-user-select: none;\n            user-select: none;\n          }\n          ._stay-quality-item::after{\n            content:"";\n            background: url(${v}) no-repeat 50% 50%;  \n            background-size: 14px;\n            position: absolute;\n            right: 15px;\n            top: 50%;\n            transform: translate(0, -52%);\n            width: 14px;\n            height: 20px;\n          }\n          @keyframes zoom {\n            0% {transform: scale(1.05)}\n            100% {transform: scale(1);${E}}\n          }\n          @keyframes fadein {\n            0% {\n              transform: translate(0, -100%);\n            }\n            100% {\n              transform: none;\n            }\n          }\n          @keyframes fadeout {\n              0% {\n                transform: translate(0,100%);\n              }\n              100% {\n                  transform: none;\n              }\n          }\n        </style>`,k=['<div id="__stay_sinffer_modal" class="__stay-modal-box" >','<div class="__stay-sinffer-content">','<div class="__stay-content">','<div class="__stay-sinffer-poster">'+q+"</div>",'<div class="_stay-sinffer-popup">','<div class="_stay-sinffer-title">'+o.title+"</div>",'<div class="_stay-sinffer-download">',_,"</div>","</div>","</div>","</div>","</div>"];return document.body.append(u.parseToDOM(O)),document.body.append(u.parseToDOM(k.join(""))),document.querySelector("#__stay_sinffer_modal")}g.classList.add("__stay-trans"),setTimeout((function(){f.classList.add("__stay-show-modal"),h.style.visibility="visible"}),400),f.addEventListener("touchmove",(t=>{t.preventDefault(),t.stopPropagation()}),!1),f.addEventListener("touchstart",(t=>{t.preventDefault(),f.classList.remove("__stay-show-modal"),h.style.animation="fadeout .5s;",setTimeout((()=>{f&&document.body.removeChild(f),document.body.removeChild(document.querySelector("#__style_sinffer_style"))}),200)}),!1);const b=document.querySelectorAll("#__stay_sinffer_modal ._stay-quality-item");if(b&&b.length)for(let t=0;t<b.length;t++)(function(e){b[t].addEventListener("touchstart",(t=>{let e=t.target.getAttribute("stay-download"),n=document.createElement("a");n.href=e,n.click()}))})()}function S(t,e,n){if(!t||"VIDEO"!=t.tagName)return null;t.setAttribute("autoplay","autoplay"),t.setAttribute("crossOrigin","anonymous");const o=document.createElement("canvas");o.width=e,o.height=n;const i=o.getContext("2d");return i.drawImage(t,0,0,o.width,o.height),o}function U(t,e,i){let r={},a=t.getAttribute("poster"),s=t.getAttribute("title"),l=t.getAttribute("src"),d=[];n=window.location.href;let c=e;if(l=u.completionSourceUrl(l),!a){let t=document.querySelector("source[type='image/webp'] img");a=t?t.getAttribute("src"):"",s||(s=t?t.getAttribute("alt"):"")}if(o.indexOf("youtube.com")>-1){let e=document.querySelector("#player-control-overlay .player-controls-background-container .player-controls-background");e||(e=document.querySelector("#player-control-overlay")),e||(e=document.querySelector(".carousel-wrapper .video-wrapper .reel-player-overlay-main-content")),e&&(c=e),r=Y(t)}else if(o.indexOf("baidu.com")>-1)r=$(t);else if(o.indexOf("bilibili.com")>-1)r=A(t);else if(o.indexOf("mobile.twitter.com")>-1){let e=document.querySelector(".r-eqz5dr .r-1pi2tsx .r-1pi2tsx .r-1udh08x .r-1p0dtai div.css-1dbjc4n.r-6koalj.r-eqz5dr.r-1pi2tsx.r-13qz1uu");e&&(c=e),r=q(t)}else if(o.indexOf("m.weibo.cn")>-1)r=O(t);else if(o.indexOf("iesdouyin.com")>-1)r=k(t);else if(o.indexOf("douyin.com")>-1){const e=window.location.pathname;r=e.indexOf("/video")>-1?D(t):P(t)}else if(o.indexOf("m.toutiao.com")>-1)r=T(t);else if(o.indexOf("m.v.qq.com")>-1)r=C(t);else if(o.indexOf("www.reddit.com")>-1)r=N(t);else if(o.indexOf("pornhub.com")>-1){let e=document.querySelector("#videoShow #videoPlayerPlaceholder .playerFlvContainer");e&&(c=e),r=I(t)}else o.indexOf("facebook.com")>-1?r=R(t):o.indexOf("instagram.com")>-1?r=j(t):o.indexOf("xiaohongshu.com")>-1?r=V(t):o.indexOf("jable.tv")>-1?r=z(t):o.indexOf("hxaa79.com")>-1&&(r=H(t));return r.downloadUrl&&(l=r.downloadUrl),l=u.completionSourceUrl(l),a||(a=r.poster),s||(s=r.title),r.qualityList&&r.qualityList.length&&(d=r.qualityList),s||(s=document.title),s||(s=u.getUrlPathName(l)),a=u.completionSourceUrl(a),r["title"]=s,r["poster"]=a,r["downloadUrl"]=l,r["hostUrl"]=n,r["qualityList"]=d,r["videoUuid"]=i,l&&v(e,c,r),r}function L(){setTimeout((()=>{E()}),400)}function E(){let t={},e=window.location.host;n=window.location.href,t.hostUrl=n;let o=null;if(e.indexOf("pornhub.com")>-1&&(o=document.querySelector("#videoShow #videoPlayerPlaceholder .mgp_videoWrapper .mgp_videoPoster img"),o||(o=document.querySelector("#videoShow #videoPlayerPlaceholder .mgp_videoWrapper")),t=M(t)),t.downloadUrl)return v(null,o,t),t}function A(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");let n=document.querySelector(".main-container .ep-info-pre .ep-info-title");return n||setTimeout((function(){return n=document.querySelector(".video .share-video-info .title-wrapper .title-name span"),n&&(e.title=n.textContent),e}),200),n&&(e.title=n.textContent),e}function q(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");let n=t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.nextElementSibling.childNodes[1];return n&&(n=n.querySelector(".css-1dbjc4n .r-92ivih.r-1t01tom .r-1t982j2.r-1j3t67a .css-1dbjc4n.r-1kw4oii a[data-testid='tweetText'] span"),n&&(e.title=u.checkCharLengthAndSubStr(n.textContent))),e}function O(t){let e={};return e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src"),n.match(/^.*\/detail\/.*/g)&&(e.title=u.checkCharLengthAndSubStr(document.querySelector(".weibo-main .weibo-text").textContent)),e}function k(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");let n=document.querySelector(".video-container img.poster");n&&(e.poster=n.getAttribute("src"));let o=document.querySelector(".desc .multi-line .multi-line_text");return o&&(e.title=o.textContent),e}function D(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");const n=document.querySelector("div[data-e2e=video-detail] div[data-e2e=detail-video-info] div h2");return n&&(e.title=n.textContent),e}function P(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");let n=t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(n){let t=n.querySelector(".imgBackground img");t&&(e.poster=t.getAttribute("src"));let o=n.querySelector(".video-info-detail .title span.e_h_fqNj");o&&(e.title=o.textContent)}return e}function T(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");const n=document.querySelector(".video .xgplayer-placeholder .xgplayer-poster");if(n){let t=n.getAttribute("style");if(t){let n=u.matchUrlInString(t);e.poster=n}}const o=document.querySelector(".video .video-header .video-title-wrapper .video-title");return o&&(e.title=o.textContent),e}function C(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");const n=document.querySelector(".mod_play .player_container .txp_poster_img");if(n){let t=n.getAttribute("src");t=u.completionSourceUrl(t),e.poster=t}const o=document.querySelector(".mod_box .mod_bd .mod_video_info .video_title");if(o){let t=o.textContent;t=t?t.trim():"";const n=document.querySelector(".mod_box .mod_bd .mod_list_slider .slider_box .item.current span");n&&(t+=n.textContent,t=t?t.trim():""),e.title=t}return e}function N(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");const n=document.querySelector("shreddit-app shreddit-title");return n&&(e.title=n.getAttribute("title")),e}function I(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src");let n=t.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement;if(n&&n.classList.contains("playerWrapper")){const t=document.querySelector("#videoShow .categoryTags .headerWrap h1");if(t){let n=t.textContent;n&&(e.title=n.trim())}const n=document.querySelector("#videoPlayerPlaceholder img.videoElementPoster");return n&&(e.poster=n.getAttribute("src")),M(e)}let o=t.parentNode.parentNode.parentNode.parentNode.parentNode;if(o&&"li"==o.tagName.toLowerCase()){let t=o.querySelector(".videoWrapper .singleVideo a img.videoThumb");if(t)return e.title=t.getAttribute("alt"),e.title&&(e.title="[Related videos] "+e.title),e.poster=t.getAttribute("src"),e}return e}function M(t){if(t=t||{},t.videoKey=u.queryURLParams(window.location.href,"viewkey"),window.VIDEO_SHOW&&(!t.videoKey||t.videoKey==window.VIDEO_SHOW.vkey)){t.title||(t.title=window.VIDEO_SHOW.videoTitle),t.poster||(t.poster=window.VIDEO_SHOW.videoImage);let e=window.VIDEO_SHOW.playerId;if(e){let n=e.split("_");if(n.length>1){let e="flashvars_"+n[1],o=window[e].mediaDefinitions;if(o&&o.length){let e=[],n="";o.forEach((o=>{"hls"==o.format&&"string"==typeof o.quality&&o.videoUrl&&e.push({downloadUrl:window.encodeURI(o.videoUrl),qualityLabel:o.quality,quality:Number(o.quality)}),!o.defaultQuality||"boolean"!=typeof o.defaultQuality&&"number"!=typeof o.defaultQuality||(n=o.defaultQuality,t.downloadUrl||(t.downloadUrl=o.videoUrl))})),t["qualityList"]=e}}}}return t}function R(t){let e={};e.poster=t.getAttribute("poster"),e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title");let n=t.parentElement.parentElement.parentElement.parentElement.parentElement;if(n&&n.classList.contains("displayed")&&"container"==n.getAttribute("data-type")){let t=n.querySelector("div[data-type='video'] img.img");t&&(e.poster=t.getAttribute("src"));let o=n.querySelector("div.displayed > div[data-type='container'] > div[data-type='container'] > div[data-type='container'] > div[data-type='text'] > div.native-text");o&&(e.title=o.textContent)}return e}function j(t){let e={};e.poster=t.getAttribute("poster")||"",e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title");let n=t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;if(n&&n.classList.contains("_ab8w")&&n.classList.contains("_ab94")&&n.classList.contains("_ab99")&&n.classList.contains("_ab9h")&&n.classList.contains("_ab9m")&&n.classList.contains("_ab9p")&&n.classList.contains("_abcm")){let t=n.querySelector("._aatk .x1uhb9sk .x10l6tqk .x78zum5 img.x5yr21d");t&&(e.poster=t.getAttribute("src"));let o=n.querySelector("._ab9f div._ae1h._ae1i ._ae2s div._ae5q._akdn div div div");o&&o.textContent&&(e.title=o.textContent.replace("... more",""))}else if(n=t.parentNode.parentNode.parentNode.parentNode.parentNode,n&&n.classList.contains("_a8b4")&&n.classList.contains("_acjh")){let t=n.querySelector("div > div > div.x9f619.x1d8287x.xz4gly6  div.x6ikm8r.x10wlt62 span");t&&(e.title=t.textContent)}return e}function V(t){let e={};e.poster=t.getAttribute("poster")||"",e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title");const n=document.querySelector(".video-container .video-banner .img-box");if(n){let t=n.getAttribute("style"),o=u.matchUrlInString(t);o&&(e.poster=u.completionSourceUrl(o))}const o=document.querySelector(".video-container .stage-bottom .author-desc-wrapper .author-desc");if(o){let t=o.textContent;t&&(t=t.replace(/^展开/g,""),e.title=u.checkCharLengthAndSubStr(t))}return e}function z(t){let e={};e.poster=t.getAttribute("poster")||"",e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title");const n=document.querySelector(".video-info .info-header .header-left h4");return n&&(e.title=n.textContent),e}function H(t){let e={};e.poster=t.getAttribute("poster")||"",e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title");const n=document.querySelector(".play_main .play_main_1");return n&&(e.title=n.textContent),e}function $(t){let e={};if(e.poster=t.getAttribute("poster")||"",e.downloadUrl=t.getAttribute("src"),e.title=t.getAttribute("title"),"activity.baidu.com"===o){const t=window.PAGE_DATA;if(t&&t.pageData&&t.pageData.remote&&t.pageData.remote.mainVideoList&&t.pageData.remote.mainVideoList.length){const o=t.pageData.remote.mainVideoList[0],i=t.pageData.remote.moreVideoList;return e["title"]=o.title,e["poster"]=o.poster,e["downloadUrl"]=o.videoUrl,i&&i.length&&i.forEach((t=>{s.size&&s.has(t.vid)||u.isURL(t.videoUrl)&&(s.add(t.vid),r.push({title:t.title,poster:t.poster,downloadUrl:window.encodeURI(t.videoUrl),hostUrl:n,videoUuid:t.vid}))})),e}e["title"]=K();const o=document.querySelector(".stickyBlock .curVideoPlay video");return o&&(e["poster"]=o.getAttribute("poster"),e["downloadUrl"]=o.getAttribute("src")),e}if("mbd.baidu.com"===o){const t=window.jsonData;if(t&&t.curVideoMeta){const n=t.curVideoMeta;if(e=W(n),e&&Object.keys(e).length)return e}return e["title"]=K(),e["poster"]=F(),e}if("haokan.baidu.com"===o){const o=window.__PRELOADED_STATE__,i=u.queryURLParams(n,"vid"),r=t.getAttribute("src");if(r&&i&&r.indexOf(i)>-1){if(o&&o.curVideoMeta){const t=o.curVideoMeta;if(e=W(t),e&&Object.keys(e).length)return e}e["title"]=K(),e["poster"]=F()}else e["title"]=t.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title")?t.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title").textContent:"",e["poster"]=t.parentElement&&t.parentElement.querySelector("img.video-img")?t.parentElement.querySelector("img.video-img").getAttribute("src"):"";return e}return"pan.baidu.com"===o&&(e["title"]=K()),e}function W(t){if(!t)return{};let e={};if(e["title"]=t.title,e["poster"]=t.poster,e["downloadUrl"]=t.playurl,t.clarityUrl&&t.clarityUrl.length){let n=[];const o=t.clarityUrl;o.forEach((t=>{t.vodVideoHW;n.push({downloadUrl:t.url,qualityLabel:t.title,quality:t.key})})),e["qualityList"]=n}return e}function F(){const t=document.querySelector(".art-player-wrapper .art-video-player .art-poster");if(t){let e=t.getAttribute("style");if(e)return u.matchUrlInString(e)}const e=document.querySelector("#bdMainPlayer .art-video-player .art-poster");if(e){let t=e.getAttribute("style");if(t)return u.matchUrlInString(t)}return""}function K(){const t=document.querySelector(".adVideoPageV3 .curVideoInfo h3.videoTitle");if(t)return t.textContent;const e=document.querySelector(".video-info .video-info-title");if(e)return e.textContent;const n=document.querySelector(".video-main .video-content .video-title .video-title-left");return n?n.textContent:""}function Y(t){const e=u.queryURLParams(n,"v");let o={};o.poster=t.getAttribute("poster")||"",o.downloadUrl=t.getAttribute("src");let i=t.getAttribute("title");o.title=i;const r=window.ytInitialPlayerResponse;if(r&&r.videoDetails&&r.streamingData&&(!e||e===r.videoDetails.videoId)){const t=r.videoDetails;let e=t.title?t.title:"";o["title"]=e;let n=t.thumbnail;if(n){let t=n.thumbnails;t&&t.length&&(o["poster"]=t.pop().url)}r.microformat&&r.microformat.playerMicroformatRenderer&&r.microformat.playerMicroformatRenderer.thumbnail&&r.microformat.playerMicroformatRenderer.thumbnail.thumbnails.length&&(o["poster"]=r.microformat.playerMicroformatRenderer.thumbnail.thumbnails[0].url);const a=r.streamingData,s=(a.adaptiveFormats,a.formats),l=s;if(i=i||"",l&&l.length&&i.replace(/\s+/g,"")===e.replace(/\s+/g,"")){let t=[],e=new Set;l.forEach((n=>{let o=n.mimeType;o.indexOf("video/mp4")>-1&&n.url&&!e.has(n.quality)&&(e.add(n.quality),t.push({downloadUrl:window.encodeURI(n.url),qualityLabel:n.qualityLabel,quality:n.quality}))})),t&&t.length&&(o["qualityList"]=t),o["downloadUrl"]=B()}else o["title"]=i||X(),o["downloadUrl"]=B();o["poster"]||(o["poster"]=G())}else o={},o["title"]=i||X(),o["downloadUrl"]=B();let a=G();return e!=r.videoDetails.videoId&&(a=`https://i.ytimg.com/vi/${e}/hqdefault.jpg`),a||(a=`https://i.ytimg.com/vi/${e}/hqdefault.jpg`),o["poster"]=a,o["downloadUrl"]&&o["downloadUrl"].indexOf("pltype=adhost")&&(o["title"]="<span>Ad·</span>"+o["title"]),o}function B(){let t=document.querySelector(".html5-video-player .html5-video-container video");return t?t.getAttribute("src"):""}function X(){const t=document.querySelector(".slim-video-metadata-header .slim-video-information-content .slim-video-information-title");if(t)return t.textContent;const e=document.querySelector("#title h1.style-scope");return e?e.textContent:""}function G(){const t=document.querySelector(".ytp-cued-thumbnail-overlay-image");if(t){let e=t.getAttribute("style");if(e)return u.matchUrlInString(e)}const e=document.querySelector(".html5-video-player .ytp-cued-thumbnail-overlay .ytp-cued-thumbnail-overlay-image");if(e){let t=e.getAttribute("style");if(t)return u.matchUrlInString(t)}const n=document.querySelector(".video-wrapper .background-style-black");if(n){let t=n.getAttribute("style");if(t)return u.matchUrlInString(t)}return""}function Q(){function e(t){let e=/^(https?:\/\/|\/).*\.(mp4|m3u8)$/;return null!=t.match(e)}let n=new Set;XMLHttpRequest.prototype.reallyOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(o,r,a,s,l){if(this.reallyOpen(o,r,a,s,l),e(r)&&!n.has(r)&&(n.add(r),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:n}),t)){let t={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:n};i.runtime.sendMessage(t,(t=>{}))}};let o=window.fetch;window.fetch=function(r,a){let s="object"==typeof r?r.url:r;if(e(s)&&!n.has(s)&&(n.add(s),console.log("VIDEO_LINK_CAPTURE: "+s),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:n}),t)){let t={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:n};i.runtime.sendMessage(t,(t=>{}))}return o(r,a)}}h(!1),document.onreadystatechange=()=>{"complete"===document.readyState&&h(!0)},Q()}let n=window.location.href,o=[],r=new Set;window.addEventListener("message",(t=>{if(!t||!t.data||!t.data.name)return;const e=t.data.name;if("VIDEO_LINK_CAPTURE"===e){let e=t.data.urls?t.data.urls:new Set;r=e;let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoPageUrl:n,videoLinkSet:r};i.runtime.sendMessage(o,(t=>{}))}else if("VIDEO_INFO_CAPTURE"===e){let e=t.data.videoList?t.data.videoList:[];o=e;let r={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoPageUrl:n,videoInfoList:o};i.runtime.sendMessage(r,(t=>{}))}else if("GET_STAY_AROUND"===e){let e=t.data.pid;i.runtime.sendMessage({from:"sniffer",operate:"GET_STAY_AROUND"},(t=>{window.postMessage({pid:e,name:"GET_STAY_AROUND_RESP",response:t})}))}}))})()}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.m=t,(()=>{var t=[];n.O=(e,o,i,r)=>{if(!o){var a=1/0;for(c=0;c<t.length;c++){o=t[c][0],i=t[c][1],r=t[c][2];for(var s=!0,l=0;l<o.length;l++)(!1&r||a>=r)&&Object.keys(n.O).every((t=>n.O[t](o[l])))?o.splice(l--,1):(s=!1,r<a&&(a=r));if(s){t.splice(c--,1);var d=i();void 0!==d&&(e=d)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[o,i,r]}})(),(()=>{n.n=t=>{var e=t&&t.__esModule?()=>t["default"]:()=>t;return n.d(e,{a:e}),e}})(),(()=>{n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()})(),(()=>{n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e)})(),(()=>{n.j=875})(),(()=>{var t={875:0};n.O.j=e=>0===t[e];var e=(e,o)=>{var i,r,a=o[0],s=o[1],l=o[2],d=0;if(a.some((e=>0!==t[e]))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)var c=l(n)}for(e&&e(o);d<a.length;d++)r=a[d],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(c)},o=self["webpackChunkstay_popup"]=self["webpackChunkstay_popup"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})();var o=n.O(void 0,[998],(()=>n(7022)));o=n.O(o)})();