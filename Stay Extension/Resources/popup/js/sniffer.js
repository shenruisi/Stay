(()=>{var e={7022:(e,t,o)=>{let n;o(7658),"undefined"!==typeof window.browser&&(n=window.browser),"undefined"!==typeof window.chrome&&(n=window.chrome);const r=n;(function(){let e=window.location.host,t=document.createElement("script");t.type="text/javascript",t.id="stay_inject_parse_video_js_"+e;let o=`\n\nlet handleVideoInfo = ${n}\n\nhandleVideoInfo();`;if(t.appendChild(document.createTextNode(o)),document.body)document.body.appendChild(t);else{const e=document.documentElement,o=new MutationObserver((()=>{document.body&&(o.disconnect(),document.body.appendChild(t))}));o.observe(e,{childList:!0})}function n(){let e=window.location.href,t=window.location.host,o=[],n=new Set;const r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let i;const l={isMobile:function(){const e=navigator.userAgent;let t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=t.filter((t=>e.includes(t)));return!!o.length},queryURLParams:function(e,t){const o=new RegExp("[?&#]+"+t+"=([^?&#]+)"),n=o.exec(e);return n&&n[1]?n[1]:""},matchUrlInString:function(e){const t=new RegExp("(https?|http)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g"),o=e.match(t);return o&&o.length?o[0]:""},isURL:function(e){return!!e&&/^http[s]?:\/\/.*/.test(e)}};function a(){i=document.querySelectorAll("video");let e=i&&i.length;e?d(i):s()}function s(){const e=new r((function(e){try{e.forEach((function(e){if(i=document.querySelectorAll("video"),"VIDEO"===e.target.nodeName&&i&&i.length)throw t=window.location.host,d(i),new Error("endloop")}))}catch(o){if("endloop"!==o.message)throw o}})),o={attributes:!0,childList:!0,characterData:!0,subtree:!0};e.observe(document,o)}function d(e){if(e&&e.length){let t=Array.from(e);t.forEach((e=>{if(!e||!(e instanceof HTMLElement))return;let t=e.getAttribute("src");if(!t){let o=e.querySelector("source");o&&(e=o,t=o.getAttribute("src"))}if(t&&n.size&&n.has(t))return;let r=u(e);r.downloadUrl&&(n.add(t),o.push(r))})),window.postMessage({name:"VIDEO_INFO_CAPTURE",videoList:o}),console.log("parseVideoNodeList-----------result---------",o)}}function u(o){let n={},r=o.getAttribute("poster"),i=o.getAttribute("title"),a=o.getAttribute("src"),s=[];if(e=window.location.href,!r){let e=document.querySelector("source[type='image/webp'] img");r=e?e.getAttribute("src"):"",i||(i=e?e.getAttribute("alt"):"")}if(t.indexOf("youtube.com")>-1?n=y(i):t.indexOf("baidu.com")>-1&&(n=c(o)),a||(a=n.downloadUrl),r||(r=n.poster),i||(i=n.title),n.qualityList&&n.qualityList.length&&(s=n.qualityList),!i){let t="";t=l.isURL(a)?new URL(a).pathname:new URL(e).pathname;let o=t.split("/");o=o.filter((e=>{if(e&&""!=e)return e})),i=o.pop()}return n["title"]=i,n["poster"]=r,n["downloadUrl"]=a,n["hostUrl"]=e,n["qualityList"]=s,n}function c(r){let i={};if("activity.baidu.com"===t){const t=window.PAGE_DATA;if(t&&t.pageData&&t.pageData.remote&&t.pageData.remote.mainVideoList&&t.pageData.remote.mainVideoList.length){const r=t.pageData.remote.mainVideoList[0],l=t.pageData.remote.moreVideoList;return i["title"]=r.title,i["poster"]=r.poster,i["downloadUrl"]=r.videoUrl,l&&l.length&&l.forEach((t=>{n.size&&n.has(t.videoUrl)||o.push({title:t.title,poster:t.poster,downloadUrl:t.videoUrl,hostUrl:e})})),i}i["title"]=m();const r=document.querySelector(".stickyBlock .curVideoPlay video");return r&&(i["poster"]=r.getAttribute("poster"),i["downloadUrl"]=r.getAttribute("src")),i}if("mbd.baidu.com"===t){const e=window.jsonData;if(e&&e.curVideoMeta){const t=e.curVideoMeta;if(i=p(t),i&&Object.keys(i).length)return i}return i["title"]=m(),i["poster"]=f(),i}if("haokan.baidu.com"===t){const t=window.__PRELOADED_STATE__,o=l.queryURLParams(e,"vid"),n=r.getAttribute("src");if(n&&o&&n.indexOf(o)>-1){if(t&&t.curVideoMeta){const e=t.curVideoMeta;if(i=p(e),i&&Object.keys(i).length)return i}i["title"]=m(),i["poster"]=f()}else i["title"]=r.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title")?r.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title").textContent:"",i["poster"]=r.parentElement&&r.parentElement.querySelector("img.video-img")?r.parentElement.querySelector("img.video-img").getAttribute("src"):"";return i}return"pan.baidu.com"===t&&(i["title"]=m()),i}function p(e){if(!e)return{};let t={};if(t["title"]=e.title,t["poster"]=e.poster,t["downloadUrl"]=e.playurl,e.clarityUrl&&e.clarityUrl.length){let o=[];const n=e.clarityUrl;n.forEach((e=>{e.vodVideoHW;o.push({downloadUrl:e.url,qualityLabel:e.title,quality:e.key})})),t["qualityList"]=o}return t}function f(){const e=document.querySelector(".art-player-wrapper .art-video-player .art-poster");if(e){let t=e.getAttribute("style");if(t)return l.matchUrlInString(t)}const t=document.querySelector("#bdMainPlayer .art-video-player .art-poster");if(t){let e=t.getAttribute("style");if(e)return l.matchUrlInString(e)}return""}function m(){const e=document.querySelector(".adVideoPageV3 .curVideoInfo h3.videoTitle");if(e)return e.textContent;const t=document.querySelector(".video-info .video-info-title");if(t)return t.textContent;const o=document.querySelector(".video-main .video-content .video-title .video-title-left");return o?o.textContent:""}function y(e){let t=h(e);return Object.keys(t).length||(t={},t["title"]=w(),t["poster"]=v(),t["downloadUrl"]=g()),t}function h(t){const o=l.queryURLParams(e,"v");let n={};const r=window.ytInitialPlayerResponse;if(r&&r.videoDetails&&r.streamingData&&o===r.videoDetails.videoId){const e=r.videoDetails;n["title"]=e.title;let o=e.thumbnail;if(o){let e=o.thumbnails;e&&e.length?n["poster"]=e.pop().url:n["poster"]=v()}else n["poster"]=v();const i=r.streamingData,l=i.formats;t=t||"";let a=e.title?e.title:"";if(l&&l.length&&t.replace(/\s+/g,"")===a.replace(/\s+/g,"")){console.log("playerResp-------adaptiveFormats------------------",t,e.title,l);let o=[],r=new Set;l.forEach((e=>{let t=e.mimeType;t.indexOf("video/mp4")>-1&&e.url&&!r.has(e.quality)&&(r.add(e.quality),o.push({downloadUrl:e.url,qualityLabel:e.qualityLabel,quality:e.quality}))})),o&&o.length&&(n["qualityList"]=o),n["downloadUrl"]=g()}}return n}function g(){let e=document.querySelector(".html5-video-player .html5-video-container video");return e?e.getAttribute("src"):""}function w(){const e=document.querySelector(".slim-video-metadata-header .slim-video-information-content .slim-video-information-title");if(e)return e.textContent;const t=document.querySelector("#title h1.style-scope");return t?t.textContent:""}function v(){const e=document.querySelector(".ytp-cued-thumbnail-overlay-image");if(console.log(e),e){console.log("overlayImg-------",e);let t=e.getAttribute("style");if(console.log("overlayImg----imgText---",t),t)return l.matchUrlInString(t)}const t=document.querySelector(".html5-video-player .ytp-cued-thumbnail-overlay .ytp-cued-thumbnail-overlay-image");if(t){let e=t.getAttribute("style");if(e)return l.matchUrlInString(e)}return""}function b(){function e(e){let t=/^(https?:\/\/|\/).*\.(mp4|m3u8)$/;return null!=e.match(t)}let t=new Set;XMLHttpRequest.prototype.reallyOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(o,n,r,i,l){this.reallyOpen(o,n,r,i,l),e(n)&&(t.has(n)||(t.add(n),console.log("VIDEO_LINK_CAPTURE: "+n),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:t})))};let o=window.fetch;window.fetch=function(n,r){let i="object"==typeof n?n.url:n;return e(i)&&(t.has(i)||(t.add(i),console.log("VIDEO_LINK_CAPTURE: "+i),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:t}))),o(n,r)}}a(),document.onreadystatechange=()=>{console.log("document.readyState==",document.readyState),"complete"===document.readyState&&(console.log("readyState-------------------",document.readyState),a(),console.log("readyStateytInitialPlayerResponseytInitialPlayerResponse-----"))},b()}let i=[],l=new Set;window.addEventListener("message",(e=>{if(!e||!e.data||!e.data.name)return;const t=e.data.name;if(console.log("snifffer.user-----\x3ee.data.name=",t),"VIDEO_LINK_CAPTURE"===t){let t=e.data.urls?e.data.urls:new Set;console.log("snifffer.VIDEO_LINK_CAPTURE-----\x3etempSet=",t),l=t;let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:l};r.runtime.sendMessage(o,(e=>{}))}else if("VIDEO_INFO_CAPTURE"===t){let t=e.data.videoList?e.data.videoList:[];i=t,console.log("snifffer.VIDEO_INFO_CAPTURE-----\x3evideoInfoList=",i);let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:i};r.runtime.sendMessage(o,(e=>{}))}}))})()}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,i)=>{if(!n){var l=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],i=e[u][2];for(var a=!0,s=0;s<n.length;s++)(!1&i||l>=i)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(a=!1,i<l&&(l=i));if(a){e.splice(u--,1);var d=r();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,r,i]}})(),(()=>{o.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return o.d(t,{a:t}),t}})(),(()=>{o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.j=875})(),(()=>{var e={875:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,l=n[0],a=n[1],s=n[2],d=0;if(l.some((t=>0!==e[t]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(s)var u=s(o)}for(t&&t(n);d<l.length;d++)i=l[d],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},n=self["webpackChunkstay_popup"]=self["webpackChunkstay_popup"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[998],(()=>o(7022)));n=o.O(n)})();