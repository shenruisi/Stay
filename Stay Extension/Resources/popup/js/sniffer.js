(()=>{var e={7022:(e,t,o)=>{let n;o(7658),"undefined"!==typeof window.browser&&(n=window.browser),"undefined"!==typeof window.chrome&&(n=window.chrome);const r=n;(function(){let e=window.location.host,t=!1;try{o(),document.addEventListener("securitypolicyviolation",(e=>{console.log("securitypolicyviolation--------------",e),console.log(e.blockedURI),console.log(e.violatedDirective),console.log(e.originalPolicy),t=!0,n()}))}catch(a){console.log("Exception----------------------------",a)}function o(){let t=document.createElement("script");t.type="text/javascript",t.id="stay_inject_parse_video_js_"+e;let o=`\n\nlet handleVideoInfo = ${n}\n\nhandleVideoInfo();`;if(t.appendChild(document.createTextNode(o)),document.body)document.body.appendChild(t);else{const e=document.documentElement,o=new MutationObserver((()=>{document.body&&(o.disconnect(),document.body.appendChild(t))}));o.observe(e,{childList:!0})}}function n(){let e=window.location.href,o=window.location.host,n=[],i=new Set;const l=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;let a;const s={isMobile:function(){const e=navigator.userAgent;let t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],o=t.filter((t=>e.includes(t)));return!!o.length},queryURLParams:function(e,t){const o=new RegExp("[?&#]+"+t+"=([^?&#]+)"),n=o.exec(e);return n&&n[1]?n[1]:""},matchUrlInString:function(e){const t=new RegExp("(https?|http)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]","g"),o=e.match(t);return o&&o.length?o[0]:""},isURL:function(e){return!!e&&/^http[s]?:\/\/.*/.test(e)}};function c(){a=document.querySelectorAll("video");let e=a&&a.length;e?u(a):d()}function d(){const e=new l((function(e){try{e.forEach((function(e){if(a=document.querySelectorAll("video"),"VIDEO"===e.target.nodeName&&a&&a.length)throw o=window.location.host,u(a),new Error("endloop")}))}catch(t){if("endloop"!==t.message)throw t}})),t={attributes:!0,childList:!0,characterData:!0,subtree:!0};e.observe(document,t)}function u(e){if(e&&e.length){let o=Array.from(e);if(o.forEach((e=>{if(!e||!(e instanceof HTMLElement))return;let t=e.getAttribute("src");if(!t){let o=e.querySelector("source");o&&(e=o,t=o.getAttribute("src"))}if(t&&i.size&&i.has(t))return;let o=f(e);o.downloadUrl&&(i.add(t),n.push(o))})),window.postMessage({name:"VIDEO_INFO_CAPTURE",videoList:n}),console.log("parseVideoNodeList-----------result---------",n),t){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:n};r.runtime.sendMessage(e,(e=>{}))}}}function f(t){let n={},r=t.getAttribute("poster"),i=t.getAttribute("title"),l=t.getAttribute("src"),a=[];if(e=window.location.href,!r){let e=document.querySelector("source[type='image/webp'] img");r=e?e.getAttribute("src"):"",i||(i=e?e.getAttribute("alt"):"")}if(o.indexOf("youtube.com")>-1?n=h(i):o.indexOf("baidu.com")>-1&&(n=p(t)),l||(l=n.downloadUrl),r||(r=n.poster),i||(i=n.title),n.qualityList&&n.qualityList.length&&(a=n.qualityList),!i){let t="";t=s.isURL(l)?new URL(l).pathname:new URL(e).pathname;let o=t.split("/");o=o.filter((e=>{if(e&&""!=e)return e})),i=o.pop()}return n["title"]=i,n["poster"]=r,n["downloadUrl"]=l,n["hostUrl"]=e,n["qualityList"]=a,n}function p(t){let r={};if("activity.baidu.com"===o){const t=window.PAGE_DATA;if(t&&t.pageData&&t.pageData.remote&&t.pageData.remote.mainVideoList&&t.pageData.remote.mainVideoList.length){const o=t.pageData.remote.mainVideoList[0],l=t.pageData.remote.moreVideoList;return r["title"]=o.title,r["poster"]=o.poster,r["downloadUrl"]=o.videoUrl,l&&l.length&&l.forEach((t=>{i.size&&i.has(t.videoUrl)||n.push({title:t.title,poster:t.poster,downloadUrl:t.videoUrl,hostUrl:e})})),r}r["title"]=g();const o=document.querySelector(".stickyBlock .curVideoPlay video");return o&&(r["poster"]=o.getAttribute("poster"),r["downloadUrl"]=o.getAttribute("src")),r}if("mbd.baidu.com"===o){const e=window.jsonData;if(e&&e.curVideoMeta){const t=e.curVideoMeta;if(r=m(t),r&&Object.keys(r).length)return r}return r["title"]=g(),r["poster"]=y(),r}if("haokan.baidu.com"===o){const o=window.__PRELOADED_STATE__,n=s.queryURLParams(e,"vid"),i=t.getAttribute("src");if(i&&n&&i.indexOf(n)>-1){if(o&&o.curVideoMeta){const e=o.curVideoMeta;if(r=m(e),r&&Object.keys(r).length)return r}r["title"]=g(),r["poster"]=y()}else r["title"]=t.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title")?t.parentElement.parentElement.querySelector("h3.land-recommend-bottom-title").textContent:"",r["poster"]=t.parentElement&&t.parentElement.querySelector("img.video-img")?t.parentElement.querySelector("img.video-img").getAttribute("src"):"";return r}return"pan.baidu.com"===o&&(r["title"]=g()),r}function m(e){if(!e)return{};let t={};if(t["title"]=e.title,t["poster"]=e.poster,t["downloadUrl"]=e.playurl,e.clarityUrl&&e.clarityUrl.length){let o=[];const n=e.clarityUrl;n.forEach((e=>{e.vodVideoHW;o.push({downloadUrl:e.url,qualityLabel:e.title,quality:e.key})})),t["qualityList"]=o}return t}function y(){const e=document.querySelector(".art-player-wrapper .art-video-player .art-poster");if(e){let t=e.getAttribute("style");if(t)return s.matchUrlInString(t)}const t=document.querySelector("#bdMainPlayer .art-video-player .art-poster");if(t){let e=t.getAttribute("style");if(e)return s.matchUrlInString(e)}return""}function g(){const e=document.querySelector(".adVideoPageV3 .curVideoInfo h3.videoTitle");if(e)return e.textContent;const t=document.querySelector(".video-info .video-info-title");if(t)return t.textContent;const o=document.querySelector(".video-main .video-content .video-title .video-title-left");return o?o.textContent:""}function h(e){let t=v(e);return Object.keys(t).length||(t={},t["title"]=b(),t["poster"]=E(),t["downloadUrl"]=w()),t}function v(t){const o=s.queryURLParams(e,"v");let n={};const r=window.ytInitialPlayerResponse;if(r&&r.videoDetails&&r.streamingData&&o===r.videoDetails.videoId){const e=r.videoDetails;n["title"]=e.title;let o=e.thumbnail;if(o){let e=o.thumbnails;e&&e.length?n["poster"]=e.pop().url:n["poster"]=E()}else n["poster"]=E();const i=r.streamingData,l=i.formats;t=t||"";let a=e.title?e.title:"";if(l&&l.length&&t.replace(/\s+/g,"")===a.replace(/\s+/g,"")){console.log("playerResp-------adaptiveFormats------------------",t,e.title,l);let o=[],r=new Set;l.forEach((e=>{let t=e.mimeType;t.indexOf("video/mp4")>-1&&e.url&&!r.has(e.quality)&&(r.add(e.quality),o.push({downloadUrl:e.url,qualityLabel:e.qualityLabel,quality:e.quality}))})),o&&o.length&&(n["qualityList"]=o),n["downloadUrl"]=w()}}return n}function w(){let e=document.querySelector(".html5-video-player .html5-video-container video");return e?e.getAttribute("src"):""}function b(){const e=document.querySelector(".slim-video-metadata-header .slim-video-information-content .slim-video-information-title");if(e)return e.textContent;const t=document.querySelector("#title h1.style-scope");return t?t.textContent:""}function E(){const e=document.querySelector(".ytp-cued-thumbnail-overlay-image");if(console.log(e),e){console.log("overlayImg-------",e);let t=e.getAttribute("style");if(console.log("overlayImg----imgText---",t),t)return s.matchUrlInString(t)}const t=document.querySelector(".html5-video-player .ytp-cued-thumbnail-overlay .ytp-cued-thumbnail-overlay-image");if(t){let e=t.getAttribute("style");if(e)return s.matchUrlInString(e)}return""}function O(){function e(e){let t=/^(https?:\/\/|\/).*\.(mp4|m3u8)$/;return null!=e.match(t)}let o=new Set;XMLHttpRequest.prototype.reallyOpen=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(n,i,l,a,s){if(this.reallyOpen(n,i,l,a,s),e(i)&&!o.has(i)&&(o.add(i),console.log("VIDEO_LINK_CAPTURE: "+i),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:o}),t)){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:o};r.runtime.sendMessage(e,(e=>{}))}};let n=window.fetch;window.fetch=function(i,l){let a="object"==typeof i?i.url:i;if(e(a)&&!o.has(a)&&(o.add(a),console.log("VIDEO_LINK_CAPTURE: "+a),window.postMessage({name:"VIDEO_LINK_CAPTURE",urls:o}),t)){let e={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:o};r.runtime.sendMessage(e,(e=>{}))}return n(i,l)}}c(),document.onreadystatechange=()=>{console.log("document.readyState==",document.readyState),"complete"===document.readyState&&(console.log("readyState-------------------",document.readyState),c(),console.log("readyStateytInitialPlayerResponseytInitialPlayerResponse-----"))},O()}let i=[],l=new Set;window.addEventListener("message",(e=>{if(!e||!e.data||!e.data.name)return;const t=e.data.name;if(console.log("snifffer.user-----\x3ee.data.name=",t),"VIDEO_LINK_CAPTURE"===t){let t=e.data.urls?e.data.urls:new Set;console.log("snifffer.VIDEO_LINK_CAPTURE-----\x3etempSet=",t),l=t;let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoLinkSet:l};r.runtime.sendMessage(o,(e=>{}))}else if("VIDEO_INFO_CAPTURE"===t){let t=e.data.videoList?e.data.videoList:[];i=t,console.log("snifffer.VIDEO_INFO_CAPTURE-----\x3evideoInfoList=",i);let o={from:"sniffer",operate:"VIDEO_INFO_PUSH",videoInfoList:i};r.runtime.sendMessage(o,(e=>{}))}}))})()}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,o),i.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,i)=>{if(!n){var l=1/0;for(d=0;d<e.length;d++){n=e[d][0],r=e[d][1],i=e[d][2];for(var a=!0,s=0;s<n.length;s++)(!1&i||l>=i)&&Object.keys(o.O).every((e=>o.O[e](n[s])))?n.splice(s--,1):(a=!1,i<l&&(l=i));if(a){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,r,i]}})(),(()=>{o.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return o.d(t,{a:t}),t}})(),(()=>{o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.j=875})(),(()=>{var e={875:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,l=n[0],a=n[1],s=n[2],c=0;if(l.some((t=>0!==e[t]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(s)var d=s(o)}for(t&&t(n);c<l.length;c++)i=l[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(d)},n=self["webpackChunkstay_popup"]=self["webpackChunkstay_popup"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[998],(()=>o(7022)));n=o.O(n)})();